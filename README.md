# 📖 TheBible API

## 📌 프로젝트 개요

TheBible API는 성경 데이터(번역본, 책, 장, 절)를 관리하고 제공하는 RESTful API입니다.
Spring Boot 기반으로 설계되었으며, DDD 원칙을 적용하여 모듈화된 구조를 갖추고 있습니다.

## 📌 기술 스택

- **Backend**: Spring Boot 3.x, Kotlin, JPA (Hibernate)
- **Database**: H2 (개발), MySQL or PostgreSQL (운영)
- **Build**: Gradle
- **Caching**: Redis (선택사항)
- **API 문서화**: SpringDoc OpenAPI (Swagger)

---

## 📌 도메인 모델

### **📍 도메인 관계도**

```
BibleTranslation (1) ───> (N) BibleBook
BibleBook (1) ───> (N) BibleChapter
BibleChapter (1) ───> (N) BibleVerse
```

- **BibleTranslation** → **BibleBook** (번역본 - 책, 1:N 관계)
- **BibleBook** → **BibleChapter** (책 - 장, 1:N 관계)
- **BibleChapter** → **BibleVerse** (장 - 절, 1:N 관계)

## 📌 API 엔드포인트

### 1️⃣ **책과 해당 장 목록 조회**

- **URL**: `GET /bibles/{translation}/books/{book}`
- **설명**: 특정 번역본에서 책을 가져오고, 해당 책의 모든 장을 조회합니다.

📌 **Request Example**

```http
GET /bibles/KJV/books/Genesis
```

📌 **Response Example**

```json
{
  "bookId": 1,
  "bookName": "Genesis",
  "abbreviation": "Gen",
  "testament": "OLD",
  "chapters": [
    {
      "chapterId": 1,
      "chapterNumber": 1
    },
    {
      "chapterId": 2,
      "chapterNumber": 2
    }
  ]
}
```

---

### 2️⃣ **특정 장과 해당 절 목록 조회**

- **URL**: `GET /bibles/books/{bookId}/chapters/{chapterNumber}`
- **설명**: 특정 책에서 특정 장과 해당 절 목록을 조회합니다.

📌 **Request Example**

```http
GET /bibles/books/1/chapters/1
```

📌 **Response Example**

```json
{
  "chapterId": 1,
  "chapterNumber": 1,
  "verses": [
    {
      "verseId": 1,
      "verseNumber": 1,
      "text": "태초에 하나님이 천지를 창조하시니라."
    }
  ]
}
```

---

### 3️⃣ **특정 성경 구절 조회**

- **URL**: `GET /bibles/{translation}/books/{book}/chapters/{chapter}/verses/{verse}`
- **설명**: 특정 번역본에서 특정 구절을 조회합니다.

📌 **Request Example**

```http
GET /bibles/KJV/books/Genesis/chapters/1/verses/1
```

📌 **Response Example**

```json
{
  "translation": "KJV",
  "bookName": "Genesis",
  "chapterNumber": 1,
  "verseNumber": 1,
  "text": "In the beginning God created the heaven and the earth."
}
```

---

### 4️⃣ **성경 구절 검색**

- **URL**: `GET /bibles/search?keyword=`
- **설명**: 입력한 키워드가 포함된 성경 구절을 검색합니다.

📌 **Request Example**

```http
GET /bibles/search?keyword=Jesus
```

📌 **Response Example**

```json
[
  {
    "verseId": 1,
    "bookName": "Matthew",
    "chapterNumber": 1,
    "verseNumber": 21,
    "text": "And she shall bring forth a son, and thou shalt call his name Jesus..."
  },
  {
    "verseId": 2,
    "bookName": "John",
    "chapterNumber": 3,
    "verseNumber": 16,
    "text": "For God so loved the world, that he gave his only begotten Son..."
  }
]
```

---

## 📌 데이터베이스 (H2 개발 환경)

### **H2 설정 (`application.yml`)**

```yaml
spring:
  datasource:
    url: jdbc:h2:mem:testdb
    driver-class-name: org.h2.Driver
    username: sa
    password:
  jpa:
    database-platform: org.hibernate.dialect.H2Dialect
    hibernate:
      ddl-auto: update
    show-sql: true
```

### **DDL 테이블 스키마 (자동 생성)**

```sql
CREATE TABLE bible_book
(
    id             BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    translation_id BIGINT       NOT NULL,
    name           VARCHAR(255) NOT NULL,
    abbreviation   VARCHAR(255) NOT NULL,
    testament      VARCHAR(10)  NOT NULL,
    book_order     INTEGER      NOT NULL
);
```

---

## 📌 실행 방법

```bash
# 프로젝트 빌드 및 실행
./gradlew bootRun
```
